require 'tapyrus'

host     = ENV.fetch('TAPYRUS_RPC_HOST')
port     = ENV.fetch('TAPYRUS_RPC_PORT').to_i
user     = ENV.fetch('TAPYRUS_RPC_USER')
password = ENV.fetch('TAPYRUS_RPC_PASSWORD')

begin
  $client = Tapyrus::RPC::TapyrusCoreClient.new(schema: 'http', host:, port:, user:, password:)
  puts "✓ Tapyrus RPC client is ready ▶︎ `$client` (#{host}:#{port})"
rescue KeyError => e
  warn "❌ Missing environment variable: #{e.message}"
  exit(1)
rescue StandardError => e
  warn "❌ Could not initialize Tapyrus RPC client: #{e.class}: #{e.message}"
  exit(1)
end
